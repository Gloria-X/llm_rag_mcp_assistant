# 计算机组成与结构

## 硬件组成

运算器、控制器、存储器、输入设备、输出设备 --> 5大部件

**运算器、控制器等部件被集成在一起统称为中央处理单元**（Central Processing, CPU）。CPU 是硬件系统的核心，用于**数据的加工处理，能完成各种算术，逻辑运算及控制功能**。

存储器是计算机系统中的**记忆设备**，分为**内部存储器和外部存储器**。前者速度高、容量小，一般用于临时存放程序、数据及中间结果。而后者容量大、速度慢，可以长期保存程序和数据。

**输入设备和输出设备合称为外部设备**（简称外设），输入设备用于输入原始数据及各种命令，而输出设备则用于输出计算机运行的结果。

## CPU

### 功能

- 程序控制。CPU通过执行指令来控制程序的执行顺序，这是CPU的重要功能。

- 操作控制。一条指令功能的实现需要若干操作信号配合来完成，CPU产生每条指令的操作信号并将操作信号送往对应的部件，控制相应的部件按指令的功能要求进行操作。

- 时间控制。CPU对各种操作进行时间上的控制，即指令执行过程中操作信号的出现时间、持续时间及出现的时间顺序都需要进行严格控制。

- 数据处理。CPU 通过对数据进行算术运算及逻辑运算等方式进行加工处理，数据加处理的结果被人们所利用。所以，对数据的加工处理也是CPU最根本的任务。

- 此外，CPU还需要**对系统内部和外部的中断（异常）做出响应，进行相应的处理**。

  > 前三条都是控制器的功能

### 组成

CPU的组成：CPU 主要由运算器、控制器、寄存器组和内部总线等部件组成

#### 运算器

由

**算术逻辑单元ALU**：实现对数据的算术和逻辑运算

**累加寄存器AC**：运算结果或源操作数的存放区

**数据缓冲寄存器DR**：暂时存放内存的指令或数据

**状态条件寄存器PSW**：保存指令运行结果的条件码内容，如溢出标志等

组成。

功能：

1. **执行所有的算术运算**，如加减乘除等，(!!!!)左移数变大
> 移动指令中的**算术左移**指令的操作结果相当于对操作数进行乘2操作
2. **执行所有的逻辑运算并进行逻辑测试**，如与、或、非、比较等

#### 控制器

由

**指令寄存器IR**：暂存CPU执行指令

**程序计数器PC**：存放指令执地址

**地址寄存器AR**：保存当前CPU所访问的内存地址

**指令译码器ID**：分析指令操作码

等组成。

> 🔺c.f. 累加寄存器AC，程序计数器PC，指令寄存器IR，地址寄存器AR

**控制整个CPU的工作，最为重要**。

🔺(!!!!!!!!!!!)CPU依据**指令周期的不同阶段**来**区分二进制的指令和数据**，因为在指令周期的不同阶段，指令会命令CPU分别去取指令或者数据。

（指令和数据的寻址方式、所在的存储单元、指令操作码的编码结果都是去除指令对指令进行分析才有的结果）

## 数据表示

### 编码

- 原码：一个数的正常二进制表示，最高位表示符号，数值0的源码有两种形式：+0(00000000)和-0(10000000)

- 反码：正数的反码即原码；负数的反码除符号位外，其他各位按位取反。

- 补码：正数的补码即原码；负数的补码是反码末位+1，若有进位则产生进位。

- 移码：无论正数负数，都是补码的符号位取反。

  >+0, -0 的补码和移码相同

机器字长为 n 时各种码制表示的带符号数的取值范围（差别在于 0 的表示）

![流水线示意图](./imgs/2.1-码制取值.jpg)

通用结论：n 位二进制数可以表示 2^n 个数值，n=2 --> (00, 01, 10, 11) 4个数值

**补码、反码：表示 2^n 个数值**，0 只有一种表示方式

**原码、反码：表示 2^n - 1 个数值**，+0，-0，数值都是0，多占了一位

### 浮点数

表示方法为`N=F*2^E`，其中 E 称为阶码，F 称为尾数，类似于一进制的科学计数法。

在浮点数的表示中，🔺**阶码为带符号的纯整数，尾数为带符号的纯小数**，要注意符号占最高位（正数0负数1），其表示格式如下：

| 阶符 | 阶码 E | 数符 | 尾数 F |
| ---- | ------ | ---- | ------ |

🔺浮点数所能表示的数值**范围由阶码确定**，所表示的数值**精度由尾数确定**。

尾数的表示采用规格化方法，也即带符号尾数的补码必须为`1.0xxxx`（负数）或者`0.1xxxx`（正数），其中x可为0或1。

**浮点数的运算**：

- 对阶：使两个数的阶码相同，**小阶向大阶看齐**，较小阶码增加几位，**尾数**就**右移**几位 (🔺小--> 大，**右**移!!!!!!!!!!!!!!!!)

- 尾数计算：相加，若是减运算，则加负数

- 结果规格化：即尾数表示规格化，带符号尾数转换为`1.0xxxx`或`0.1xxxx`

  

## 校验码

码距：任意两个合法编码之间至少有多少个二进制位不同。**在两个编码中，从A码到B码转换所需要改变的位数称为码距**，如 A: 00 要转换为 B: 11，码距为2。

一般来说，码距越大，越利于纠错和检错。

#### 奇偶校验码

**只能检错，不能纠错**

在编码中增加1位校验位来使编码中**1的个数**为**奇数（奇校验）**或者**偶数（偶校验）**，从而使**码距变为2**

对于奇校验，可以检测代码中奇数位出错的编码，但不能发现偶数位出错的情况

#### 循环冗余校验码 CRC

**只能检错，不能纠错**

使用 CRC 编码，需要先约定一个生成多项式G(x)，生成多项式的最高位和最低位必须是1。假设原始信息有m位，则对应多项式M(x)。生成校验码思想就是**在原始信息位后追加若干校验位，使得追加的信息能被G(x)整除。接收方接收到带校验位的信息，然后用G(x)整除。余数为0，则没有错误；反之则发生错误**。

例：

![CRC](./imgs/2.2-CRC.jpg)

>  模2运算的规则是按位运算，不发生借位和进位



#### 海明码

**验错 + 纠错**

本质是**利用奇偶性**来检错和纠错的检验方法，构成方法是在数据位之间的确定位置上插入k个校验位，通过扩大码距实现检错和纠错。
> 码距 = 2，检错；码距 >= 3，才可能纠错

设数据位是n位，校验位是k位，则n和k必须满足以下关系：**2^k-1>=n+k**

例：

![海明码](./imgs/2.2-海明码.jpg)
